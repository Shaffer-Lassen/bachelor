# Bachelor Thesis - Christian Shaffer-Lassen

This GitHub repository contains the code for the experimental work conducted as part of my bachelor thesis.

## Contents

The work includes the following components:

1. **Comparison of MDE Models**  
   A comparison of four different Monocular Depth Estimation (MDE) models trained on a subset of the NYU Depth V2 dataset:
   - One model trained from scratch.
   - Two models with pretrained CNN encoders. One with ResNet another with DenseNet.
   - One model with a pretrained Swin-Transformer Backbone
   - One model using the foundation model DINOv2 as the backbone.  
   These models are evaluated based on their depth estimation metrics.

2. **Model with Pseudo-Labels**  
   Model training on a subset of the COCO dataset with pseudo-labels generated by the state-of-the-art model DepthAnythingV2 (DAv2).  
   The pseudo-labels represent relative depth, which is the default output of DAv2.

3. **Ablation Study**  
   An ablation study that investigates and maps the effects of individual components in the models described in section (1).

## Required Packages

The dependencies are listed in `requirements.txt`. Follow the steps below to set up a virtual environment and install the required packages:

1. **Create a virtual environment:**
	```bash
	python3 -m venv myenv
	source myenv/bin/activate
	pip install -r requirements.txt

## Data preparation

The data used for model training is a subset of the NYUv2 dataset. It is obtained from the GitHub repository "FastDepth": https://github.com/dwofk/fast-depth/tree/master. 
As described by FastDepth, data can be downloaded by the following command (32GB):

	```bash
	mkdir data; cd data
	wget http://datasets.lids.mit.edu/fastdepth/data/nyudepthv2.tar.gz
	tar -xvf nyudepthv2.tar.gz && rm -f nyudepthv2.tar.gz
	cd ..

If you want to train a model on the annotated COCO data, the unlabeled images can be downloaded here: https://cocodataset.org/#download
Model used for producing pseudo-labels is DepthAnythingv2, that can be found here: https://github.com/DepthAnything/Depth-Anything-V2/tree/main

## Model Training and Evaluation

For model training and evaluation, please refer to the script folder. 

